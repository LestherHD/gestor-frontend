import{a as re}from"./chunk-C6TJHT6G.js";import{a as H,b as J,c as ie}from"./chunk-D7TFSAOW.js";import{b as K,c as _,d as Q,e as W,f as X,i as v,l as Y,o as Z,q as ee,x as te}from"./chunk-4NMRZLOK.js";import{$ as n,Da as k,Fa as d,Fb as I,Ga as u,H as R,N as p,O as f,Qa as c,Ra as F,Wc as M,Xc as B,Yc as G,Za as q,aa as C,cd as A,dd as O,fd as P,hc as L,hd as $,id as z,jc as N,ka as h,na as r,ob as T,tb as V,xa as o,ya as i,yc as j,za as U,zc as D}from"./chunk-52LX7MYE.js";import{k as w}from"./chunk-LTV2K23E.js";var g=class{constructor(m,t,a,e,l,x,b,S,y,E){this.id=m,this.usuario=t,this.contrasenia=a,this.nombres=e,this.apellidos=l,this.correo=x,this.telefono=b,this.sucursal=S,this.principal=y,this.sesion=E}};function oe(s,m){if(s&1&&(o(0,"c-alert",32),c(1),i()),s&2){let t=u(2);n(),F(t.mensaje)}}function ne(s,m){if(s&1&&(o(0,"c-alert",33),c(1),i()),s&2){let t=u(2);n(),F(t.mensaje)}}function ae(s,m){s&1&&(o(0,"c-form-feedback",14),c(1,"Campo requerido."),i()),s&2&&r("valid",!1)}function se(s,m){s&1&&(o(0,"c-form-feedback",14),c(1,"Solo se permiten valores num\xE9ricos del 0 al 9 con longitud m\xE1xima de 8 car\xE1cteres"),i()),s&2&&r("valid",!1)}function le(s,m){s&1&&(o(0,"c-form-feedback",14),c(1,"Campo requerido."),i()),s&2&&r("valid",!1)}function ce(s,m){s&1&&(o(0,"c-form-feedback",14),c(1,"Correo inv\xE1lido."),i()),s&2&&r("valid",!1)}function me(s,m){if(s&1){let t=k();o(0,"form",6)(1,"h1"),c(2,"Registrarse"),i(),o(3,"p",7),c(4,"Crea tu cuenta"),i(),h(5,oe,2,1,"c-alert",8)(6,ne,2,1,"c-alert",9),o(7,"c-input-group",10)(8,"div",11)(9,"input",12),d("blur",function(){p(t);let e=u();return f(e.functionsUtils.removeSpaces("nombres",e.form))}),i(),o(10,"label",13),c(11,"Nombres"),i(),o(12,"c-form-feedback",14),c(13,"Campo requerido."),i()()(),o(14,"c-input-group",10)(15,"div",11)(16,"input",15),d("blur",function(){p(t);let e=u();return f(e.functionsUtils.removeSpaces("apellidos",e.form))}),i(),o(17,"label",16),c(18,"Apellidos"),i(),o(19,"c-form-feedback",14),c(20,"Campo requerido."),i()()(),o(21,"c-input-group",10)(22,"div",11)(23,"input",17),d("blur",function(){p(t);let e=u();return f(e.functionsUtils.removeSpaces("telefono",e.form))}),i(),o(24,"label",18),c(25,"Tel\xE9fono"),i(),h(26,ae,2,1,"c-form-feedback",19)(27,se,2,1,"c-form-feedback",19),i()(),o(28,"c-input-group",10)(29,"div",11)(30,"input",20),d("blur",function(){p(t);let e=u();return f(e.functionsUtils.removeSpaces("correo",e.form))}),i(),o(31,"label",21),c(32,"Correo"),i(),h(33,le,2,1,"c-form-feedback",19)(34,ce,2,1,"c-form-feedback",19),i()(),o(35,"c-input-group",10)(36,"div",11)(37,"input",22),d("blur",function(){p(t);let e=u();return f(e.functionsUtils.removeSpaces("usuario",e.form))}),i(),o(38,"label",23),c(39,"Usuario"),i(),o(40,"c-form-feedback",14),c(41,"Campo requerido."),i()()(),o(42,"c-input-group",10)(43,"div",11)(44,"input",24),d("blur",function(){p(t);let e=u();return f(e.functionsUtils.removeSpaces("contrasenia",e.form))})("keyup",function(e){p(t);let l=u();return f(l.validarRepetirContrasenia(e))}),i(),o(45,"label",25),c(46,"Contrase\xF1a"),i(),o(47,"c-form-feedback",14),c(48,"Campo requerido."),i()()(),o(49,"c-input-group",10)(50,"div",11)(51,"input",26),d("blur",function(){p(t);let e=u();return f(e.functionsUtils.removeSpaces("confirmarContrasenia",e.form))})("keyup",function(e){p(t);let l=u();return f(l.validarRepetirContrasenia(e))}),i(),o(52,"label",27),c(53,"Confirmar contrase\xF1a"),i(),o(54,"c-form-feedback",14),c(55,"Campo requerido."),i()()(),o(56,"div",28)(57,"button",29),d("click",function(){p(t);let e=u();return f(e.registrarse())}),c(58,"Crear cuenta"),i()(),o(59,"div",30)(60,"c-col")(61,"a",31),d("click",function(){p(t);let e=u();return f(e.login())}),c(62," Iniciar sesi\xF3n "),i()()()()}if(s&2){let t=u();r("formGroup",t.form),n(5),r("ngIf",t.mostrarError),n(),r("ngIf",t.mostrarSuccess),n(2),r("cFormFloating",!0),n(),r("valid",t.functionsUtils.campoRequerido(t.form,"nombres","CR")==1?!1:null)("maxLength",70),n(3),r("valid",!1),n(3),r("cFormFloating",!0),n(),r("valid",t.functionsUtils.campoRequerido(t.form,"apellidos","CR")==1?!1:null)("maxLength",60),n(3),r("valid",!1),n(3),r("cFormFloating",!0),n(),r("valid",t.functionsUtils.campoRequerido(t.form,"telefono","CR")==1||t.functionsUtils.campoRequerido(t.form,"telefono","TI")==3?!1:null)("maxLength",8),n(3),r("ngIf",t.functionsUtils.getValueMap("telefono")==1),n(),r("ngIf",t.functionsUtils.getValueMap("telefono")==3),n(2),r("cFormFloating",!0),n(),r("valid",t.functionsUtils.campoRequerido(t.form,"correo","CR")==1||t.functionsUtils.campoRequerido(t.form,"correo","EI")==2?!1:null)("maxLength",60),n(3),r("ngIf",t.functionsUtils.getValueMap("correo")===1),n(),r("ngIf",t.functionsUtils.getValueMap("correo")===2),n(2),r("cFormFloating",!0),n(),r("valid",t.functionsUtils.campoRequerido(t.form,"usuario","CR")==1?!1:null)("maxLength",25),n(3),r("valid",!1),n(3),r("cFormFloating",!0),n(),r("valid",t.functionsUtils.campoRequerido(t.form,"contrasenia","CR")==1?!1:null)("maxLength",35),n(3),r("valid",!1),n(3),r("cFormFloating",!0),n(),r("valid",t.functionsUtils.campoRequerido(t.form,"confirmarContrasenia","CR")==1?!1:null)("maxLength",35),n(3),r("valid",!1),n(3),r("disabled",t.form.invalid||t.contraseniasNoIguales||t.errorUniques||t.service.deshabilitarBotones)}}function ue(s){let m=s.value;return/^[0-9\s]+$/.test(m)?null:{onlyNumbersAndSpaces:!0}}var Ue=(()=>{let m=class m{constructor(a,e,l){this.service=a,this.router=e,this.functionsUtils=l,this.mostrarError=!1,this.mensaje=""}ngOnInit(){return w(this,null,function*(){this.service.mostrarSpinner=!1,this.service.deshabilitarBotones=!1,this.mostrarSuccess=!1,this.form=new X({nombres:new v("",_.required),apellidos:new v("",_.required),telefono:new v("",[_.required,ue,_.minLength(8)]),correo:new v("",[_.email,_.required]),usuario:new v("",_.required),contrasenia:new v("",_.required),confirmarContrasenia:new v("",_.required)}),this.contraseniasNoIguales=!1,this.errorUniques=!1})}validarRepetirContrasenia(a){let e=this.form.controls.contrasenia.value,l=this.form.controls.confirmarContrasenia.value;clearTimeout(this.timer),this.timer=setTimeout(()=>{e&&l?e!=l?(this.mensaje="Las contrase\xF1as no coinciden",this.mostrarError=!0,this.contraseniasNoIguales=!0):(this.mensaje="",this.mostrarError=!1,this.contraseniasNoIguales=!1):(this.mostrarError=!1,this.mensaje="",this.contraseniasNoIguales=!1)},0)}llenarObjeto(a){let l=this.form.controls.usuario.value.toString().trim().toLowerCase(),x=this.service.hashMD5(this.form.controls.contrasenia.value.toString().trim()),b=this.form.controls.nombres.value.toString().trim(),S=this.form.controls.apellidos.value.toString().trim(),y=this.form.controls.telefono.value.toString().trim(),E=this.form.controls.correo.value.toString().trim().toLowerCase();return new g(0,l,x,b,S,E,y,null,null,"N")}campoRequerido(a,e){return a.controls[e].value.trim()===""&&a.controls[e].touched?1:a.controls[e]?.touched&&a.controls[e]?.hasError("email")?2:a.controls[e].touched&&(!/^[0-9\s]+$/.test(a.controls[e].value.trim())||a.controls[e].value.length<8)?3:0}registrarse(){return w(this,null,function*(){let a=this.llenarObjeto(this.form),e=new re("","","","",null,a,0,0);this.errorUniques=!1,this.mostrarError=!1,this.mensaje="",yield this.service.getFromEntityAndMethodStringPromise("usuarios","getValidadorUniques",e).then(l=>{l&&(this.mostrarError=!0,this.mensaje=l,this.errorUniques=!0)}).catch(l=>{console.error(l)}),clearTimeout(this.timer),this.timer=setTimeout(()=>{this.errorUniques=!1},1e3),this.mostrarError||(this.service.deshabilitarBotones=!0,this.mostrarSuccess=!0,this.service.mostrarSpinner=!0,this.service.saveEntity("usuarios",a).subscribe(l=>{this.service.mostrarSpinner=!1,l?(this.mensaje="Usuario registrado con \xE9xito",clearTimeout(this.timer),this.timer=setTimeout(()=>{this.errorUniques=!1,this.mostrarSuccess=!1,this.service.deshabilitarBotones=!1,this.functionsUtils.navigateOption(this.router,"login")},2400)):(this.service.mostrarSpinner=!1,this.mostrarError=!0,this.service.deshabilitarBotones=!1)},l=>{this.service.deshabilitarBotones=!1,this.service.mostrarSpinner=!1,console.error(l)}))})}login(){this.functionsUtils.navigateOption(this.router,"login")}};m.\u0275fac=function(e){return new(e||m)(C(J),C(I),C(H))},m.\u0275cmp=R({type:m,selectors:[["app-register"]],standalone:!0,features:[q],decls:8,vars:1,consts:[[1,"bg-light","dark:bg-transparent","min-vh-100","d-flex","flex-row","align-items-center"],[1,"justify-content-center"],["lg","7","md","9","xl","6"],[1,"mx-4"],[1,"p-4"],["cForm","",3,"formGroup",4,"ngIf"],["cForm","",3,"formGroup"],[1,"text-body-secondary"],["color","danger",4,"ngIf"],["color","success",4,"ngIf"],[1,"mb-2"],[3,"cFormFloating"],["id","nombres","autoComplete","name","cFormControl","","placeholder","Nombres","formControlName","nombres",3,"blur","valid","maxLength"],["cLabel","","for","nombres"],[3,"valid"],["id","apellidos","autoComplete","name","cFormControl","","placeholder","Apellidos","formControlName","apellidos",3,"blur","valid","maxLength"],["cLabel","","for","apellidos"],["id","telefono","autoComplete","telefono","cFormControl","","placeholder","Tel\xE9fono","formControlName","telefono",3,"blur","valid","maxLength"],["cLabel","","for","telefono"],[3,"valid",4,"ngIf"],["id","correo","autoComplete","email","type","email","cFormControl","","placeholder","Correo electr\xF3nico","formControlName","correo",3,"blur","valid","maxLength"],["cLabel","","for","correo"],["id","usuario","autoComplete","name","cFormControl","","placeholder","Usuario","formControlName","usuario",3,"blur","valid","maxLength"],["cLabel","","for","usuario"],["id","contrasenia","autoComplete","new-password","cFormControl","","placeholder","Contrase\xF1a","type","password","formControlName","contrasenia",3,"blur","keyup","valid","maxLength"],["cLabel","","for","contrasenia"],["id","confirmarContrasenia","autoComplete","new-password","cFormControl","","placeholder","Confirmar contrase\xF1a","type","password","formControlName","confirmarContrasenia",3,"blur","keyup","valid","maxLength"],["cLabel","","for","confirmarContrasenia"],[1,"d-grid"],["cButton","","color","success",2,"color","white",3,"click","disabled"],[2,"margin","0 auto","text-align","center"],["cButton","","color","link",1,"px-0",3,"click"],["color","danger"],["color","success"]],template:function(e,l){e&1&&(o(0,"div",0)(1,"c-container")(2,"c-row",1)(3,"c-col",2)(4,"c-card",3)(5,"c-card-body",4),h(6,me,63,34,"form",5),i()()()()()(),U(7,"app-custom-spinner")),e&2&&(n(6),r("ngIf",l.form))},dependencies:[P,z,$,j,D,M,G,A,L,N,V,T,te,Y,K,Q,W,Z,ee,B,O,ie],styles:["button[_ngcontent-%COMP%]    {background-color:#00b3ba!important;border-color:#00b3ba!important}"]});let s=m;return s})();export{Ue as RegisterComponent};
