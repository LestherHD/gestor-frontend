import{a as ge}from"./chunk-XNTE45YH.js";import"./chunk-TWSSJELN.js";import{a as fe,b as ve,d as be}from"./chunk-752RHEJ5.js";import{a as ie}from"./chunk-DOS7QCTW.js";import{a as ee,b as te,c as he}from"./chunk-EJCMS3OD.js";import{c as ne,d as g,e as oe,f as re,g as w,j as c,m as ae,p as se,r as le,s as me,t as de,u as ce,x as ue,y as pe}from"./chunk-GWKOQUCK.js";import"./chunk-G3FCNO7I.js";import{Ea as t,Eb as D,Fa as n,Ga as v,Ka as I,M as B,Ma as h,Na as u,Oc as q,Pc as z,Qa as j,Sc as H,T as _,U as S,V as C,W as M,Wd as X,Xa as e,Ya as b,Za as E,Zb as G,_a as O,ca as A,eb as V,fa as s,ga as F,ld as $,md as L,me as Y,nd as Q,ra as f,sd as Z,ua as d,vd as J,xc as U,xd as K,yb as N,yd as W,zb as k,zc as R}from"./chunk-VQT32GZP.js";import{k as T}from"./chunk-LTV2K23E.js";var y=class{constructor(m,a,o){this.id=m,this.producto=a,this.orden=o}};function xe(l,m){if(l&1){let a=I();t(0,"div"),e(1,`
            `),t(2,"button",28),h("click",function(){_(a);let r=u();return S(r.modal(1,null))}),e(3,`
              `),C(),v(4,"svg",29),e(5,`
            `),n(),e(6,`
          `),n()}}function _e(l,m){if(l&1){let a=I();t(0,"tr"),e(1,`
                `),t(2,"td"),e(3),n(),e(4,`
                `),t(5,"td"),e(6),n(),e(7,`
                `),t(8,"td"),e(9),n(),e(10,`
                `),t(11,"td"),e(12),n(),e(13,`
                `),t(14,"td"),e(15),n(),e(16,`
                `),t(17,"td"),e(18),n(),e(19,`
                `),t(20,"td"),e(21,`
                  `),t(22,"button",28),h("click",function(){let r=_(a).$implicit,i=u();return S(i.modal(3,r))}),e(23,`
                    `),C(),v(24,"svg",30),e(25,`
                  `),n(),e(26,`
                  `),M(),t(27,"button",31),h("click",function(){let r=_(a).$implicit,i=u();return S(i.modal(2,r))}),e(28,`
                    `),C(),v(29,"svg",32),e(30,`
                  `),n(),e(31,`
                  `),M(),t(32,"button",33),h("click",function(){let r=_(a).$implicit,i=u();return S(i.modalEliminar(r))}),e(33,`
                    `),C(),v(34,"svg",34),e(35,`
                  `),n(),e(36,`

                `),n(),e(37,`
              `),n()}if(l&2){let a=m.$implicit,o=u();s(3),b(a.id),s(3),b(a.producto.nombre),s(3),E("Q",o.functionsUtils.formatPrice(a.producto.precio),""),s(3),b(a.producto.tipoProducto.nombre),s(3),b(a.producto.estado=="A"?"Activo":"Inactivo"),s(3),b(a.orden)}}function Se(l,m){if(l&1&&(t(0,"c-alert",35),e(1),n()),l&2){let a=u();j("color",a.type),s(),b(a.mensaje)}}function Ce(l,m){l&1&&(t(0,"c-input-group",16)(1,"div",17)(2,"label",36),e(3,"Id"),n(),v(4,"input",37),n()())}function Ee(l,m){if(l&1&&(t(0,"option",38),e(1),n()),l&2){let a=m.$implicit;d("value",a.id),s(),E(" ",a.nombre," ")}}function we(l,m){if(l&1&&(t(0,"div",39),v(1,"img",40),n()),l&2){let a=u();s(),d("src",a.imagePreview,A)}}function Fe(l,m){if(l&1&&(t(0,"c-alert",35),e(1),n()),l&2){let a=u();j("color",a.type),s(),b(a.mensaje)}}function ye(l,m){if(l&1&&(t(0,"form",41)(1,"span",42),e(2),n()()),l&2){let a=u();d("formGroup",a.formEliminar),s(2),O("Confirmar eliminar el registro: ",a.formEliminar.controls.id.value," - ",a.formEliminar.controls.nombre.value,"")}}function P(l){let m=l.value;if(!/^\d+$/.test(m))return{onlyNumbers:!0};let a=Number(m);return a<1||a>5?{outOfRange:!0}:null}var Je=(()=>{let m=class m{constructor(o,r,i){this.service=o,this.dataUtils=r,this.functionsUtils=i,this.deshabilitarBotones=!1,this.mostrarMensaje=!1,this.imagePreview=null,this.listResponse=[],this.type="",this.mensaje="",this.nombreAccion="",this.modo=0,this.deshabilitarBotones=!1,this.mostrarMensaje=!1,this.mostrarModalCrud=!1,this.mostrarModalEliminar=!1,this.pagination=new fe,this.pagination.page=0,this.pagination.pageSize=5,this.pagination.maxSize=1,this.imagePreview=null}ngOnInit(){this.resetForm(),this.getAll(),this.getAllProducts()}resetForm(){this.form=new w({id:new c({value:"",disabled:!0}),productoId:new c("",g.required),orden:new c("",[P,g.required])})}llenarForm(o){this.form=new w({id:new c({value:o.id,disabled:!0}),productoId:new c(o.producto.id,g.required),orden:new c(o.orden,[P,g.required])}),this.cargarImagen(null,o.producto.id)}llenarFormDisabled(o){this.form=new w({id:new c({value:o.id,disabled:!0}),productoId:new c({value:o.producto.id,disabled:!0},g.required),orden:new c({value:o.orden,disabled:!0},[P,g.required])}),this.cargarImagen(null,o.producto.id)}llenarObjeto(o){let r=this.listProducts.find(p=>p.id===Number(o.controls.productoId.value)),i=new y(o.controls.id.value,r,o.controls.orden.value);return this.cargarImagen(null,r.id),i}modal(o,r){this.imagePreview=null,this.mostrarModalCrud=!0,this.modo=o,this.deshabilitarBotones=!1;let i=document.getElementById("inputCodigo");i&&i.focus(),this.modo===1?(this.nombreAccion="Agregar",this.resetForm()):this.modo===2?(this.nombreAccion="Editar",this.llenarForm(r)):this.modo===3&&(this.nombreAccion="Ver",this.llenarFormDisabled(r))}modalEliminar(o){this.nombreAccion="Eliminar",this.mostrarModalEliminar=!0,this.deshabilitarBotones=!1,this.formEliminar=new w({id:new c({value:o.id,disabled:!0}),nombre:new c({value:o.producto.nombre,disabled:!0})})}guardar(){if(this.service.mostrarSpinner=!0,this.deshabilitarBotones=!0,this.modo===1){if(this.form&&this.form.valid){let o=this.llenarObjeto(this.form);this.service.saveEntity("productosFavoritos",o).subscribe(r=>{this.type=r.error?"danger":"success",this.mensaje=r.mensaje,this.deshabilitarBotones=!0,this.mostrarMensaje=!0,this.service.mostrarSpinner=!1,setTimeout(()=>{this.mostrarMensaje=!1,this.mostrarModalCrud=!!r.error,this.deshabilitarBotones=!r.error,r.error||this.getAll()},2e3)},r=>{this.service.mostrarSpinner=!1,this.deshabilitarBotones=!1,this.type="danger",this.mensaje="Ha ocurrido un error al insertar los datos",this.mostrarMensaje=!0,setTimeout(()=>{this.mostrarMensaje=!1},1500),console.error("Error al consumir Post")})}}else if(this.modo===2&&this.form&&this.form.valid){let o=this.llenarObjeto(this.form);this.service.editEntity("productosFavoritos",o).subscribe(r=>{this.type=r.error?"danger":"success",this.mensaje=r.mensaje,this.deshabilitarBotones=!0,this.mostrarMensaje=!0,this.service.mostrarSpinner=!1,setTimeout(()=>{this.mostrarMensaje=!1,this.mostrarModalCrud=!!r.error,this.deshabilitarBotones=!r.error,r.error||this.getAll()},2e3)},r=>{this.service.mostrarSpinner=!1,this.deshabilitarBotones=!1,this.type="danger",this.mensaje="Ha ocurrido un error al actualizar los datos",this.mostrarMensaje=!0,setTimeout(()=>{this.mostrarMensaje=!1},1500),console.error("Error al consumir Post")})}}eliminar(){return T(this,null,function*(){this.service.mostrarSpinner=!0,this.deshabilitarBotones=!0,this.service.deleteEntity("productosFavoritos",this.formEliminar.controls.id.value).subscribe(o=>{this.type=o.error?"danger":"success",this.mensaje=o.mensaje,this.deshabilitarBotones=!0,this.mostrarMensaje=!0,setTimeout(()=>{this.mostrarModalEliminar=!!o.error,this.service.mostrarSpinner=!1,this.deshabilitarBotones=!1,this.mostrarMensaje=!1},2e3),this.getAll()},o=>{this.service.mostrarSpinner=!1,this.type="danger",this.deshabilitarBotones=!1,this.mensaje="Ha ocurrido un error al eliminar el registro",this.mostrarMensaje=!0,setTimeout(()=>{this.mostrarMensaje=!1},2e3),console.error("Error al consumir delete")})})}closeModal(){this.resetForm(),this.mostrarModalCrud=!1}closeModalDelete(){this.resetForm(),this.mostrarModalEliminar=!1}getAll(){this.service.mostrarSpinner=!0,this.service.getAllItemsFromEntity("productosFavoritos").subscribe(o=>{this.listResponse=o,this.service.mostrarSpinner=!1})}getAllProducts(){this.service.getAllItemsFromEntity("productos").subscribe(o=>{this.listProducts=o})}cargarImagen(o,r){let i=null;o!=null?i=this.listProducts.find(x=>x.id===Number(o.value)):i=this.listProducts.find(x=>x.id===r),console.log("prod.imagen: ",i.imagen);let p=this.functionsUtils.base64ToBlob(i.imagen);this.imagePreview=this.functionsUtils.blobToUrl(p)}};m.\u0275fac=function(r){return new(r||m)(F(te),F(ie),F(ee))},m.\u0275cmp=B({type:m,selectors:[["app-favoritos"]],standalone:!0,features:[V],decls:92,vars:26,consts:[["xs","12"],[1,"mb-4"],[1,"card-header"],[2,"display","flex","justify-content","space-between"],[4,"ngIf"],[1,"text-center","scroll"],["cTable","",3,"striped"],["scope","col"],[4,"ngFor","ngForOf"],[3,"close","submit","showModal","tittle","disabledSubmit","disabledOthersButtons","showSubmit"],[1,"d-flex","justify-content-center"],[1,"col-10"],["cForm","",3,"formGroup"],[3,"color",4,"ngIf"],[1,"col-auto"],["class","mb-2",4,"ngIf"],[1,"mb-2"],[1,"col-12"],["for","producto",1,"fw-bold"],["id","producto","cSelect","","formControlName","productoId",3,"change"],[3,"value",4,"ngFor","ngForOf"],[3,"valid"],[1,"col-12","mt-3"],["class","justify-content-center d-flex",4,"ngIf"],["for","orden",1,"fw-bold"],["id","orden","autoComplete","orden","formControlName","orden","cFormControl","",3,"blur","maxLength","valid"],[1,"justify-content-center","col-11"],[3,"formGroup",4,"ngIf"],["cButton","","color","success","variant","outline","size","sm",3,"click"],["cIcon","","name","cilPlus"],["cIcon","","name","cilZoom"],["cButton","","color","info","variant","outline","size","sm",3,"click"],["cIcon","","name","cilPencil"],["cButton","","color","danger","variant","outline","size","sm",3,"click"],["cIcon","","name","cilTrash"],[3,"color"],["for","id",1,"fw-bold"],["id","id","autoComplete","id","formControlName","id","cFormControl",""],[3,"value"],[1,"justify-content-center","d-flex"],["alt","Vista Previa",2,"max-width","350px","max-height","270px",3,"src"],[3,"formGroup"],[2,"word-wrap","break-word"]],template:function(r,i){r&1&&(t(0,"c-row"),e(1,`
  `),t(2,"c-col",0),e(3,`
    `),t(4,"c-card",1),e(5,`
      `),t(6,"c-card-header",2),e(7,`

        `),t(8,"div",3),e(9,`
          `),t(10,"strong"),e(11,"Productos muestra"),n(),e(12,`
          `),f(13,xe,7,0,"div",4),e(14,`
        `),n(),e(15,`
      `),n(),e(16,`
      `),t(17,"c-card-body"),e(18,`
        `),t(19,"c-container"),e(20,`
          `),t(21,"div",5),e(22,`
            `),t(23,"table",6),e(24,`
              `),t(25,"thead"),e(26,`
              `),t(27,"tr"),e(28,`
                `),t(29,"th",7),e(30,"Id"),n(),e(31,`
                `),t(32,"th",7),e(33,"Nombre"),n(),e(34,`
                `),t(35,"th",7),e(36,"Precio"),n(),e(37,`
                `),t(38,"th",7),e(39,"Tipo de producto"),n(),e(40,`
                `),t(41,"th",7),e(42,"Estado"),n(),e(43,`
                `),t(44,"th",7),e(45,"Posici\xF3n"),n(),e(46,`
                `),t(47,"th",7),e(48,"Acciones"),n(),e(49,`
              `),n(),e(50,`
              `),n(),e(51,`
              `),t(52,"tbody"),e(53,`
              `),f(54,_e,38,6,"tr",8),e(55,`
              `),n(),e(56,`
            `),n(),e(57,`
          `),n(),e(58,`
        `),n(),e(59,`
      `),n(),e(60,`
    `),n(),e(61,`
  `),n(),e(62,`
`),n(),v(63,"app-custom-spinner"),t(64,"app-modal-crud",9),h("close",function(){return i.closeModal()})("submit",function(){return i.guardar()}),t(65,"div",10)(66,"div",11)(67,"form",12),f(68,Se,2,2,"c-alert",13),t(69,"div",14),f(70,Ce,5,0,"c-input-group",15),t(71,"c-input-group",16)(72,"div",17)(73,"label",18),e(74),n(),t(75,"select",19),h("change",function(x){return i.cargarImagen(x.target,null)}),f(76,Ee,2,2,"option",20),n(),t(77,"c-form-feedback",21),e(78,"Campo requerido."),n()(),t(79,"div",22),f(80,we,2,1,"div",23),n()(),t(81,"c-input-group",16)(82,"div",17)(83,"label",24),e(84),n(),t(85,"input",25),h("blur",function(){return i.functionsUtils.removeSpaces("orden",i.form)}),n(),t(86,"c-form-feedback",21),e(87,"Valor inv\xE1lido, ingrese un valor del 1 al 5."),n()()()()()()()(),t(88,"app-modal-delete",9),h("close",function(){return i.closeModalDelete()})("submit",function(){return i.eliminar()}),t(89,"div",26),f(90,Fe,2,2,"c-alert",13)(91,ye,3,3,"form",27),n()()),r&2&&(s(13),d("ngIf",i.listResponse&&i.listResponse.length<5),s(10),d("striped",!0),s(31),d("ngForOf",i.listResponse),s(10),d("showModal",i.mostrarModalCrud)("tittle",i.nombreAccion)("disabledSubmit",i.form.invalid||i.deshabilitarBotones)("disabledOthersButtons",i.deshabilitarBotones)("showSubmit",i.modo!==3),s(3),d("formGroup",i.form),s(),d("ngIf",i.mostrarMensaje),s(2),d("ngIf",i.modo!==1),s(4),E("Producto ",i.modo===1?"*":"",""),s(2),d("ngForOf",i.listProducts),s(),d("valid",!1),s(3),d("ngIf",i.imagePreview),s(4),E("Orden ",i.modo===1?"*":"",""),s(),d("maxLength",1)("valid",i.functionsUtils.numeroValido(i.form,"orden",1,5,1)),s(),d("valid",!1),s(2),d("showModal",i.mostrarModalEliminar)("tittle",i.nombreAccion)("disabledSubmit",i.deshabilitarBotones)("disabledOthersButtons",i.deshabilitarBotones)("showSubmit",!0),s(2),d("ngIf",i.mostrarMensaje),s(),d("ngIf",i.formEliminar))},dependencies:[H,z,J,q,W,K,Y,X,D,N,k,U,G,ue,ae,de,ce,ne,me,oe,re,Q,ve,he,be,$,L,R,Z,pe,se,le,ge],styles:['@charset "UTF-8";ngb-pagination[_ngcontent-%COMP%]     ul>li:not(.active)>a{color:#00b3bae6!important}ngb-pagination[_ngcontent-%COMP%]     ul>li.active>a{background-color:#00b3bae6!important;border-color:#00b3ba80!important}.scroll[_ngcontent-%COMP%]{max-height:55vh;overflow:scroll}@media only screen and (max-width: 767px){td[_ngcontent-%COMP%]{word-wrap:break-word;max-width:50vw}}@media only screen and (min-width: 768px) and (max-width: 1023px){td[_ngcontent-%COMP%]{word-wrap:break-word;max-width:40vw}}@media only screen and (min-width: 1024px){td[_ngcontent-%COMP%]{word-wrap:break-word;max-width:10vw}}li[_ngcontent-%COMP%]{cursor:pointer}']});let l=m;return l})();export{Je as FavoritosComponent};
